\documentclass[12pt, addpoints, answers]{exam} % добавить или удалить answers в скобках, чтобы показать ответы
%\usepackage[T2A, T1]{fontenc}
%\usepackage[utf8x]{inputenc}
%\usepackage[greek, russian]{babel}
%\usepackage[OT1]{fontenc}

\usepackage{polyglossia}

\setdefaultlanguage{russian}
\setotherlanguages{english, greek}
\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{Linux Libertine O}
% http://www.linuxlibertine.org/index.php?id=91&L=1

%\usepackage{mathtools}
\usepackage{comment}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\DeclareMathOperator{\E}{\mathbb{E}}
\DeclareMathOperator{\Var}{\mathbb{V}\mathrm{ar}}
\DeclareMathOperator{\Cov}{\mathbb{C}\mathrm{ov}}
\let\P\relax
\DeclareMathOperator{\P}{\mathbb{P}}
\newcommand{\cN}{\mathcal{N}}
\newcommand{\hbeta}{\hat{\beta}}

\usepackage{floatrow}
%\newfloatcommand{capbtabbox}{table}[][\FBwidth]

\begin{document}

\pagestyle{headandfoot}
\runningheadrule
\firstpageheader{Невероятная регата}{Первый тур, «В открытое море»}{Задача 1-1}

\firstpageheadrule
\runningheader{Невероятная регата}{Первый тур, «В открытое море»}{Задача 1-2}

\firstpagefooter{}{}{}
\runningfooter{}{}{}
\runningfootrule




\hqword{Задача}
\hpgword{Страница}
\hpword{Максимум}
\hsword{Баллы}
\htword{Итого}
\pointname{\%}
%\renewcommand{\solutiontitle}{\noindent\textbf{Решение:}\par\noindent}
\renewcommand{\solutiontitle}{}

%Таблица с результатами заполняется проверяющим работу. Пожалуйста, не делайте в ней пометок.

%\begin{center}
%  \gradetable[h][questions]
%\end{center}

\vspace{0.2in}

\makebox[\textwidth]{Команда:\enspace\hrulefill}

\vspace{0.2in}

%\makebox[\textwidth]{Настроение:\enspace\hrulefill}

\textbf{Восьминогий Кракен}. У Кракена 8 ног-шупалец. Если отрубить одно щупальце, то в замен него с вероятностью $1/4$ вырастает новое; с вероятностью $1/4$ вырастает два новых; с вероятностью $1/2$, слава Океану, не вырастает ничего. 

Против Кракена бьётся сам Капитан! Он наносит точные удары и безупречно умело уворачивается от ударов Кракена.

\begin{enumerate}
\item Какова вероятность того, что Капитан победит, отрубив ровно 10 щупалец?
\item Какова вероятность того, что бой Кракена и Капитана продлится вечно?
\item Сколько щупалец в среднем отрубит Капитан прежде чем победит?
\end{enumerate}


\begin{solution}

Если отрублено 10 щупалец, значит либо был один удар породивший два новых щупальца, либо было два удара, породивших по одному новому, а все остальные удары не порождали новых щупалец.

Искомая вероятность равна: $8\cdot 0.5^9 \cdot 0.25^1 + C_8^2 0.5^8 0.25^2$.

Вероятность вечного боя равна нулю. Достаточно доказать, что с вероятностью один за конечное время побеждается одноногий Кракен. А эта вероятность удовлетворяет уравнению: $p=\frac{1}{4}p + \frac{1}{4}p^2 + \frac{1}{2} 1$. Единственный осмысленный корень у этого уравнения --- $1$.

Замечаем, что на победу над $k$-шупальцевым Кракеном уходим в $k$ раз больше ударов в среднем чем на победу на $1$-щупальцевым. Отсюда:

\[
e_1=1 + 0.5\cdot 0 + 0.25\cdot e_1 + 0.25 \cdot 2e_1
\]

Решаем, получаем $e_1=4$ и $e_8=32$

\end{solution}


\newpage

\runningheader{Невероятная регата}{Первый тур, «В открытое море»}{Задача 1-2}

\vspace{0.2in}

\makebox[\textwidth]{Команда:\enspace\hrulefill}

\vspace{0.2in}


\textbf{Разбавленный ром}. Пират Злопамятный Джо очень любит неразбавленный ром. Из-за
того, что он много пьёт, у него проблемы с памятью, и он помнит не
больше, чем три последних пинты. Хозяин таверны с вероятностью 1/4 разбавляет
каждую подаваемую пинту рома. Если по ощущением Джо половина выпитых
пинт или больше была разбавлена, то он разносит таверну к чертям
собачьим.


\begin{enumerate}
\item Какова вероятность того, что хозяин таверны не успеет подать Джо третью пинту рома?
\item Сколько в среднем пинт выпьет Джо, прежде чем разнесёт таверну?
\end{enumerate}


\begin{solution}
Либо первая пинта разбавлена, либо первая неразбавлена, а вторая разбавлена, то есть 
\[
0.25 + 0.75\cdot 0.25 =0.4375
\]

Рисуем граф:


Составляем систему (индекс --- количество выпитых неразбавленных пинт):

\[
\begin{cases}
e_0=\frac{1}{4} + \frac{3}{16}2 + \frac{9}{16}(2+e_2) \\
e_2=1+\frac{3}{4}e_2 + \frac{1}{4}e_0
\end{cases}
\]

Находим $e_0=64/7\approx 9$

\end{solution}

\newpage

\runningheader{Невероятная регата}{Первый тур, «В открытое море»}{Задача 1-3}

\vspace{0.2in}

\makebox[\textwidth]{Команда:\enspace\hrulefill}

\vspace{0.2in}


\textbf{$XY$ в степени $Z$}. Чтобы поступить на службу Её Величества, пиратам предлагается следующая задача. Случайные величины $X$, $Y$ и $Z$ равномерны на отрезке $[0;1]$ и независимы.

\begin{enumerate}
\item Найдите функцию распределения случайной величины $-\ln X$
\item Найдите функцию распределения случайной величины $-(\ln X + \ln Y)$
\item Найдите функцию распределения случайной величины $-Z(\ln X + \ln Y)$
\item Какое распределение имеет случайная величина $(XY)^Z$?
\end{enumerate}

\begin{solution}
Начало из домашки! Для $t>0$:
\[
\P(-\ln X \leq t)=\P(\ln X > -t)=\P(X > e^{-t})=1-e^{-t}
\]

Итого, 
\[
F_{-\ln X}(t)=\begin{cases}
0, \, t < 0 \\
1-e^{-t}, \, t \geq 0
\end{cases}
\]

Из геометрических соображений легко найти $\P(XY < a)$ для $a\in (0;1)$:
\[
\P(XY < a)=a + \int_a^1 \frac{a}{x} \, dx=a-a\ln a
\]

Переходим ко второму пункту, для $t>0$:
\[
\P(-(\ln X + \ln Y) < t)=\P(XY > e^{-t})= 1-e^{-t} -t e^{-t}
\]

Итого:
\[
F_{-\ln X - \ln Y}(t)=\begin{cases}
0, \, t < 0 \\
1-e^{-t} - te^{-t}, \, t \geq 0
\end{cases}
\]

После дифференциирования получаем функцию плотности для $S=-\ln X - \ln Y$:

\[
f_S(s)=\begin{cases}
0, \, s < 0 \\
se^{-s}, \, s \geq 0
\end{cases}
\]

Приближаемся к финальной вероятности:

\[
\P(ZS > t)= \int_t^{\infty} \int_{t/s}^1  se^{-s} \, dz\, ds= 
\int_t^{\infty} (s-t)\cdot e^{-s} \, ds= \ldots = e^{-t}
\]

Сравниваем результат с первым пунктом и приходим к выводу, что величина $(XY)^Z$ имеет равномерное распределение на $[0;1]$.

\end{solution}

\newpage

\runningheader{Невероятная регата}{Второй тур, «На абордаж»}{Задача 2-1}

\vspace{0.2in}

\makebox[\textwidth]{Команда:\enspace\hrulefill}

\vspace{0.2in}

\textbf{Тортики}. Пираты очень любят тортики и праздновать день рождения! Если хотя бы у одного пирата на корабле день рождения, то все, включая капитана, празднуют и кушают тортики. Корабль в праздничный день дрейфует под действием ветра и не факт, что в нужном направлении. 

\begin{enumerate}

\item Сколько пиратов нужно нанять капитану, чтобы ожидаемое количество праздничных дней было равно 100?

\item Сколько пиратов нужно нанять капитану, чтобы максимизировать ожидаемое количество рабочих пирато-дней (произведение числа пиратов на число рабочих дней)? 

\end{enumerate}

\begin{solution}
Если нанято $n$ пиратов, то вероятность, того, что в конкретный день все работают равна $(364/365)^n$. Следовательно, ожидаемое количество праздничных дней равно $365(1-(364/365)^n)$.

Решаем уравнение

\[
1-(364/365)^n=100/365
\]

Получаем, 
\[
n=\frac{\ln 265- \ln 365}{ \ln 364 - \ln 365}\approx 117
\]

Ожидаемое количество рабочих пирато-дней равно: $365n(364/365)^n$. 

Получаем 
\[
n^*=1/(\ln 365 - \ln 364)\approx 364
\]

\end{solution}


\newpage

\runningheader{Невероятная регата}{Второй тур, «На абордаж»}{Задача 2-2}

\vspace{0.2in}

\makebox[\textwidth]{Команда:\enspace\hrulefill}

\vspace{0.2in}


\textbf{Девятый вал}. На побережье пиратского острова одна за одной набегают волны. Высота каждой волны --- равномерная на $[0;1]$ случайная величина. Высоты волн независимы. Пираты называют волну «большой», если она больше предыдущей и больше следующей. Пираты называют волну «рекордной», если она больше всех предыдущих волн от начала наблюдения. Обозначим события $B_i= \{ i\text{-ая волна была большой} \}$ и $R_i=\{ i\text{-ая волна была рекордной} \}$.

\begin{enumerate}
\item Найдите $\P(R_{100})$, $\P(B_{100})$
\item Капитан насчитал 100 волн. Сколько в среднем из них были «рекордными»?
\item Найдите $\P(R_{99} | R_{100})$, $\P(R_{100}|B_{100})$
\end{enumerate}

\begin{solution}
\begin{enumerate}
\item $\P(R_{100})=1/100$ (максимум из 100 величин должен плюхнуться на сотое место), $\P(B_{100})=1/3$ (максимум из трёх величин должен плюхнуться на второе место)
\item $\E(X)=1+\frac{1}{2} + \frac{1}{3}+\ldots + \frac{1}{100}\approx \ln 100 \approx 4.6$. Т.к. $X=X_1+X_2+\ldots + X_{100}$ и $\E(X_i)=1/i$.
\item $\P(R_{99} | R_{100})=1/99$, $\P(R_{100}|B_{100})=3/101$

Для проверки: $\P(R_{99} \cap R_{100})=98!/100!$ ($100!$ --- всего перестановок, $98!$ --- первые 98 можно переставлять свободно, а в конце должны идти второй наибольшое и наибольшее). $\P(R_{100} \cap B_{100})=1/101$ (максимум из 101 числа плюхнется на 100ое место).
\end{enumerate}
\end{solution}

\newpage

\runningheader{Невероятная регата}{Второй тур, «На абордаж»}{Задача 2-3}

\vspace{0.2in}

\makebox[\textwidth]{Команда:\enspace\hrulefill}

\vspace{0.2in}

\textbf{Три сундука}. Три пирата, Генри Рубинов, Френсис Пиастров и Эдвард Золотов играют одной командой в игру. В комнате в ряд, слева направо, стоят в случайном порядке три закрытых внешне неотличимых сундука: с рубинами, пиастрами и золотом. Общаться после начала игры они не могут, но могут заранее договориться о стратегии. Они заходят в комнату по очереди. Каждый из них может открыть два сундука по своему выбору. После каждого пирата комната возвращается уборщицей идеально точно в исходное состояние. Если Рубинов откроет коробку с рубинами, Писатров --- с пиастрами, а Золотов --- с золотом, то их команда выигрывает. Если хотя бы один из пиратов не найдёт свою цель, то их команда проигрывает.

\begin{enumerate}
\item Какова вероятность выигрыша, если все пираты пробуют открыть первый и второй сундуки?
\item Какова оптимальная стратегия?
\item Какова вероятность выигрыша при использовании оптимальной стратегии?
\end{enumerate}

\begin{solution}
Если все пираты открывают первый и второй сундуки, то вероятность выигрыша равна нулю.

Оптимальная стратегия (одна из). Три пирата заранее договариваются, о названиях сундуков. Они называют эти три сундука (ещё до игры)  «рубиновым», «пиастровым» и «золотым». Генри Рубинов должен начать с открытия рубинового сундука, Френсис Пиастров --- с пиастрового, Эдвард Золотов --- с золотого. Далее каждый пират должен открыть тот сундук, на который указывает предмет, лежащий в первом открытом им сундуке. Например, если Генри Рубинов, открыв сначала рубиновый сундук обнаруживает там пиастры, он должен открывать пиастровый сундук.

Вероятность победы при такой стратегии легко находится перебором 6 возможных вариантов и равна\ldots Та-дам!!! $2/3$.

\end{solution}


\end{document}