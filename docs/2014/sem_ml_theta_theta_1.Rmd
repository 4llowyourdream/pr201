```{r, message=FALSE}
library("maxLik")
```

Задача. Величины $X_1$, $X_2$, \ldots, $X_n$ независимы и имеют функцию плотности $f(x)=\theta x^{\theta-1}$ при $x\in [0;1]$. По 200 наблюдениям оказалось, что $\sum \ln x_i=-220$. 

Оцените параметр $\theta$ методом максимального правдоподобия, проверьте $H_0$: $\theta=1$ с помощью трёх тестов.


Функция правдподобия равна 
\[
\ell(\theta)=200\ln \theta + (\theta-1)\cdot (-220)
\]


Задаём функцию правдоподобия в R:

```{r}
ell <- function(theta) {
  ans <- 200*log(theta) + 
    (theta-1)*(-220)
  return(ans)
}

```

Пробуем функцию в нескольких точках
```{r}
ell(0)
ell(5)
```

Оцениваем модель:
```{r}
report <- maxLik(logLik = ell, start = 1)
summary(report)
```

В этой задаче экстремум можно найти руками без R
```{r}
10/11
```


Проверяем гипотезу $H_0$: $\theta=1$ с помощью LR-теста:

```{r}
LR <- 2*(ell(10/11)-ell(1))
LR
```

Критическое значение равно:
```{r}
qchisq(0.95, df=1)
```

Вывод: $H_0$ не отвергается


Тест Вальда:
```{r}
info <- summary(report)
se <- info$estimate[1,2]
(10/11-1)^2/se^2
```


Первая и вторая производные правдоподобия в точке $\theta=1$ для LM-теста:
```{r}
lp <- numericGradient(f=ell, t0 = 1)
lpp <- numericHessian(f=ell, t0 = 1)
lp
lpp
```

LM-статистика:
```{r}
lp^2/(-lpp)
```

